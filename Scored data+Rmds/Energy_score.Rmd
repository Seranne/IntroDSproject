---
title: "energy"
output: html_document
---

```{r}
library(readr)
library(tidyverse)
library(dplyr)
library(ggplot2)
```

```{r}
Education <- read_csv("d:/Documents/GitHub/IntroDSproject/WDI data split/Education.csv")
En1<- select(Education, "CountryName", "CountryCode", "Year", "SE.ADT.1524.LT.ZS")
En1 <- En1[order(-En1$Year),]
En1<- na.omit(En1)
En1 <- En1%>% distinct(CountryName, .keep_all = TRUE)
En1 <- En1 %>% mutate(rank_eng1 = rank(-En1$SE.ADT.1524.LT.ZS))
En1$rank_eng1<- as.numeric(as.factor(En1$rank_eng1))


En2<- select(Education, "CountryName", "CountryCode", "Year", "SE.ADT.LITR.ZS")
En2 <- En2[order(-En2$Year),]
En2<- na.omit(En2)
En2 <- En2%>% distinct(CountryName, .keep_all = TRUE)
En2 <- En2 %>% mutate(rank_eng2 = rank(-En2$SE.ADT.LITR.ZS))
En2$rank_eng2<- as.numeric(as.factor(En2$rank_eng2))

En3<- select(Education, "CountryName", "CountryCode", "Year", "SG.GEN.PARL.ZS")
En3 <- En3[order(-En3$Year),]
En3<- na.omit(En3)
En3 <- En3%>% distinct(CountryName, .keep_all = TRUE)
En3 <- En3 %>% mutate(rank_eng3 = rank(-En3$SG.GEN.PARL.ZS))
En3$rank_eng3<- as.numeric(as.factor(En3$rank_eng3))


litjoin <- left_join(En1, En2, "CountryName")
Education <- select(litjoin,"CountryName", "rank_eng1", "rank_eng2")
Education <- Education%>% mutate(score_edu = (rank_eng1 + rank_eng2)/2)
Education <- Education %>% mutate(finalrank_edu = rank(Education$score_edu))
write.csv(Education, file = "Education_score.csv")


Gender<- select(En3,"CountryName", "rank_eng3")
Gender <- Gender%>% mutate(score_edu = rank_eng3)
Gender <- Gender %>% mutate(finalrank_gen = rank(Gender$score_edu))

write.csv(Gender, file = "Gender.csv")
```

