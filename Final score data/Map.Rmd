---
title: "World plot"
output: html_document
---

```{r}
library(tidyverse)
library(rworldmap)
library(ggplot2)
library(gridExtra)

ourindex <- read_csv("CalculatedOurindex.csv")
test <- joinCountryData2Map(ourindex, joinCode = "NAME", nameJoinColumn = "CountryName")

par(mai=c(0,0,0.2,0),xaxs="i",yaxs="i")
p1 <- mapCountryData( test, nameColumnToPlot="finalindex" )
```


```{r}
par(mai=c(0,0,0.2,0),xaxs="i",yaxs="i")

#joining the data to a map
finalindexplot <- joinCountryData2Map(ourindex,
                                      joinCode = "NAME",
                                      nameJoinColumn = "CountryName"
)

#creating a user defined colour palette
op <- palette(c('blue','green', 'yellow','orange','red'))

#find quartile breaks
cutVector <- quantile(finalindexplot@data[["finalindex"]],na.rm=TRUE) 

#classify the data to a factor
finalindexplot@data[["Happy-categories"]] <- cut(finalindexplot@data[["finalindex"]],
                                                 c(1,25,75,100,125,150,180),
                                                 include.lowest=TRUE )
#rename the categories
levels(finalindexplot@data[["Happy-categories"]]) <- c('Very High', 'High','High Average','Low Average','Low','Very Low')  

#mapping
mapCountryData(finalindexplot, 
               nameColumnToPlot='Happy-categories',
               catMethod='categorical',
               mapTitle='Happiness Index', 
               colourPalette='palette',
               oceanCol='lightblue',
               missingCountryCol='white',
               borderCol='black')
```

# WHR

```{r}
whr <- read_csv("/IntroDSproject/Source Data/World Happiness Report/2016.csv")
View(whr)
tester <- joinCountryData2Map(whr, joinCode = "NAME", nameJoinColumn = "Country")

par(mai=c(0,0,0.2,0),xaxs="i",yaxs="i")
p2 <- mapCountryData(tester, nameColumnToPlot="Happiness Rank")


```

```{r}
mp <- NULL
mapWorld <- borders("world", colour="gray50", fill="gray50") # create a layer of borders
mp <- ggplot() +   mapWorld

#Now Layer the cities on top
mp <- mp+ geom_point(whr, aes(x=Country, y=Happiness.Rank) ,color="blue", size=3) 
mp
```


